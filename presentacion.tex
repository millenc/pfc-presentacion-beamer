\documentclass{beamer}

\mode<presentation>
{
  \usetheme{Madrid}
  \usecolortheme{default}
  \usefonttheme{structurebold}
  \setbeamertemplate{navigation symbols}{}
  \setbeamertemplate{caption}[numbered]
} 

\usepackage[spanish]{babel}
\usepackage[utf8x]{inputenc}

% Gráficos
\usepackage{tikz}
\usetikzlibrary{shapes,shadows,arrows}
\usepackage{pgfplots}
\pgfplotsset{compat=newest}
\usepackage{float}
\usepackage{subcaption}

% Algoritmos
\usepackage[linesnumbered]{algorithm2e}
\renewcommand*{\algorithmcfname}{Algoritmo}
\let\oldnl\nl% Store \nl in \oldnl
\newcommand{\nonl}{\renewcommand{\nl}{\let\nl\oldnl}}

% Captions
\setbeamertemplate{caption}{\raggedright\insertcaption\par}

\title[Detección de riesgos ambientales]{Aplicación de un método de interpolación basado en índices de solapamiento a la detección de riesgos ambientales}
\author{Mikel Pintor Araus}
\institute[UPNA]
{
  Universidad Pública de Navarra\\
  Escuela Técnica Superior de Ingenieros Industriales y de Telecomunicación
}
\date{23 de julio 2014}

\begin{document}
 
\begin{frame}
  \titlepage
\end{frame}

\begin{frame}{Índice}  
  \tableofcontents
\end{frame}

\section{Teoría de conjuntos difusos}

\subsection{Conjuntos difusos}
\begin{frame}{Conjuntos difusos}
      \begin{block}{Definición: Conjunto difuso}
      Dado un conjunto de referencia (o universo) \emph{U}, un \emph{conjunto difuso} \emph{A} sobre \emph{U} es un conjunto tal que:\\
      \begin{equation}
      A=\{(u_{i},\mu_{A}(u_{i}))\arrowvert u_{i} \in U\}
      \end{equation}
      donde \begin{math}\mu_{A}:U\rightarrow[0,1]\end{math} es la \emph{función de pertenencia}\index{función de pertenencia} (o \emph{grado de pertenencia}) de \emph{A}.
      \end{block}
      	\begin{itemize}
      	\item Introducidos por L.A. Zadeh en 1965.
      	\item Extensión de los conjuntos clásicos.
      	\item Permiten modelar información vaga o imprecisa.
      	\end{itemize}
\end{frame}

\subsection{T-normas y operadores de agregación}
\begin{frame}{T-normas}
	  Las \emph{t-normas} son una clase de funciones que generalizan el mínimo ($\min(x,y)$) y ,por tanto, la conjunción clásica ($x\wedge y$):
      \begin{block}{Definición: T-norma}
		Una t-norma es una operación binaria \emph{T} en el intervalo $[0,1]$ que es conmutativa, asociativa, monótona y tiene el valor \emph{1} como elemento neutro. Es decir, una función $T : [0,1]^2 \rightarrow [0,1]$ tal que $\forall x,y,z \in [0,1]$:
		\begin{enumerate}
		   \item $T(x,y) = T(y,x)$ (Conmutatividad)
		   \item $T(x,T(y,z)) = T(T(x,y),z)$ (Asociatividad)
		   \item $T(x,y) \leq T(x,z)$ cuando $y \leq z$ (Monotonía)
		   \item $T(x,1) = x$ (Elemento neutro)
		  \end{enumerate}
      \end{block}
\end{frame}

\begin{frame}{T-normas: algunos ejemplos}
	\begin{itemize}
		\item \bfseries Mínimo o t-norma de Gödel: $T_{G}(x,y) = \min\{x,y\}$
		\item \bfseries Producto: $T_{P}(x,y) = x \cdot y$
		\item \bfseries \L{}ukasiewicz: $T_{L}(x,y) = \max\{x+y-1,0\}$
	\end{itemize}
	\vspace{0.2cm}
	\newlength\figureheight
    \newlength\figurewidth 
	\setlength\figureheight{2cm}
	\setlength\figurewidth{3cm}
	\input{figures/t-norms/min-3dplot.tikz}
	\setlength\figureheight{2cm}
	\setlength\figurewidth{3cm}
	\input{figures/t-norms/prod-3dplot.tikz}
	\centering
	\setlength\figureheight{2cm}
	\setlength\figurewidth{3cm}
	\input{figures/t-norms/luka-3dplot.tikz}
\end{frame}

\begin{frame}{Operadores de agregación}
	\begin{block}{Definición: operador de agregación}
	Una función $M : [a,b]^{n} \rightarrow [a,b]$ es un operador de agregación si es monótona y no decreciente en cada una de sus componentes y además cumple que $M(a, a, \cdots,a) = a$ y $M(b, b, \cdots,b) = b$.
	\end{block}
	Algunos ejemplos de operadores de agregación:
	\begin{itemize}
		\item \bfseries Media aritmética: $M(x_{1},x_{2},\cdots,x_{n}) = \frac{1}{n}\sum\limits_{i=1}^{n}x_{i}$
		\item \bfseries Media geométrica: $M(x_{1},x_{2},\cdots,x_{n}) = (\prod\limits_{i=1}^{n}x_{i})^{\frac{1}{n}}$
		\item \bfseries Mediana: \normalfont Se toma el elemento central del conjunto ordenado de argumentos.
		\item \bfseries Máximo: $M(x_{1},x_{2},\cdots,x_{n}) = \max(x_{1},x_{2},\cdots,x_{n})$
		\item \bfseries Mínimo: $M(x_{1},x_{2},\cdots,x_{n}) = \min(x_{1},x_{2},\cdots,x_{n})$
	\end{itemize}
\end{frame}

\subsection{Funciones de solapamiento}
\begin{frame}{Funciones de solapamiento}
Las funciones de solapamiento generalizan los operadores de intersección tales como el mínimo o, en general, las t-normas:
	\begin{block}{Definición: función de solapamiento}
	Una función de solapamiento es una función $G_{O} : [0,1]^{2} \rightarrow [0,1]$ que cumple:
	\begin{enumerate}
	   \item $G_{O}(x,y) = G_{O}(y,x) \;\; \forall \; x,y \in [0,1]$ 
	   \item $G_{O}(x,y) = 0$ si y sólo si $x \cdot y = 0$
	   \item $G_{O}(x,y) = 1$ si y sólo si $x \cdot y = 1$
	   \item $G_{O}$ es creciente
	   \item $G_{O}$ es continua
	\end{enumerate}
	\end{block}
\end{frame}

\begin{frame}{Funciones de solapamiento (cont.)}
	Algunos ejemplos de funciones de solapamiento:
	\begin{figure}
	\begin{subfigure}{0.45\textwidth}
		\caption{$G_{O}(x,y) = \min\{x,y\}$}
		\setlength\figureheight{3cm}
		\setlength\figurewidth{4cm}
		\input{figures/overlap-functions/overlap-min-3dplot.tikz}
	\end{subfigure}
	\qquad
	\begin{subfigure}{0.45\textwidth}
		\caption{$G_{O}(x,y) = \sqrt{x \cdot y}$}
		\setlength\figureheight{3cm}
		\setlength\figurewidth{4cm}
		\input{figures/overlap-functions/overlap-sqrt-3dplot.tikz}
	\end{subfigure}
	\end{figure}
\end{frame}

\begin{frame}{Funciones de solapamiento (cont.)}
	\begin{block}{Teorema: Construcción de funciones de solapamiento}
		Una función $G_{O} : [0,1]^{2} \rightarrow [0,1]$ es una función de solapamiento si y sólo si puede ser expresada como:
		\begin{equation}
		G_{O}(x,y) = \frac{f(x,y)}{f(x,y) + h(x,y)}
		\end{equation}
		para cualesquiera $f,h: [0,1]^{2} \rightarrow [0,1]$ tales que:
		\begin{enumerate}
		   \item f y h son simétricas;
		   \item f es no decreciente y h es no creciente;
		   \item $f(x,y) = 0$ si y sólo si $min(x.y) = 0$;
		   \item $h(x,y) = 0$ si y sólo si $min(x.y) = 1$;
		   \item f y h son continuas
		\end{enumerate}
	\end{block}
\end{frame}

\begin{frame}{Funciones de solapamiento (cont.)}
	Algunos ejemplos de construcción de funciones de solapamiento: 
	\vspace{0.5cm}
	\begin{enumerate}
		\item Si $f(x,y)=min(x,y)$ y $h(x,y) = max(1-x,1-y)$ entonces: 
		\begin{equation}
		G_{O}(x,y) = min(x,y)
		\end{equation}
		\item Si $f(x,y)=\sqrt{x \cdot y}$ y $h(x,y) = max(1-x,1-y)$ entonces: 
		\begin{equation}G_{O}(x,y) = \frac{\sqrt{x \cdot y}}{\sqrt{x \cdot y} + max(1-x,1-y)}
		\end{equation}
		\item Si $f(x,y)=\sqrt{x \cdot y}$ y $h(x,y) = 1 - x \cdot y $ entonces: 
		\begin{equation}G_{O}(x,y) = \frac{\sqrt{x \cdot y}}{\sqrt{x \cdot y} + 1 - x \cdot y}
		\end{equation}
	\end{enumerate}
\end{frame}

\subsection{Índices de solapamiento}
\begin{frame}{Índices de solapamiento}
	\begin{block}{Definición: índice de solapamiento}
		Un índice de solapamiento es una función $O : FS(U) \times FS(U) \rightarrow [0,1]$ tal que:
		\begin{enumerate}
		\item $O(A,B) = 0$ si y sólo si A y B tienen soportes disjuntos, es decir: 
			\begin{equation}
				A(u_{i}) \cdot B(u_{i}) = 0 \qquad \forall u_{i} \in U
			\end{equation}
		\item $O(A,B) = O(B,A)$\label{BO2}
		\item Si $B \leq C$, entonces $O(A,B) \leq O(A,C)$\label{BO3}
		\end{enumerate}
	\end{block}
	\begin{itemize}
		\item Los índices de solapamiento proporcionan una medida de similaridad entre dos conjuntos difusos.
		\item Muy útiles para determinar ``cómo de parecidos'' son dos conjuntos difusos.
	\end{itemize}
\end{frame}

\begin{frame}{Índices de solapamiento (cont.)}
	\begin{block}{Teorema: construcción de índices de solapamiento}
		\begin{enumerate}
			\item Sea $M : [0,1]^{2} \rightarrow [0,1]$ una función de agregación tal que $M(x_{1},\cdots,x_{n}) = 0$ si y sólo si $x_{1} = \cdots = x_{n} = 0$
			\item Sea $G_{O} : [0,1]^{2} \rightarrow [0,1]$ una función de solapamiento.
		\end{enumerate}
		Entonces, la función $O: F(U) \times F(U) \rightarrow [0,1]$ definida como:
		\begin{equation}
		O(A,B) = M(G_{O}(A(u_{1}),B(u_{1})),\cdots,G_{O}(A(u_{n}),B(u_{n})))
		\end{equation}
		es un índice de solapamiento.
	\end{block}
\end{frame}

\begin{frame}{Índices de solapamiento (cont.)}
Algunos ejemplos de construcción de índices de solapamiento:
\begin{itemize}
	\item Si $M = \text{Media aritmética}$ y $G_O = x \cdot y$:
	\begin{equation}
	O_{\pi}(A,B) = \frac{1}{n}\sum_{i=1}^{n}\mu_A(x_i) \cdot \mu_B(x_i)
	\end{equation}
	\item Si $M = \max(x_1,\cdots,x_n)$ y $G_O = \min(x,y)$:
	\begin{equation}
	O_{Z}(A,B) = \max\limits_{i=1}^{n}(\min(\mu_A(x_i),\mu_B(x_i)))
	\end{equation}
	%\item Si $M = \text{Media aritmética}$ y $G_O = \sqrt{x \cdot y}$:
	%\begin{equation}
	%O_{\sqrt{\text{ }}}(A,B) =  \frac{1}{n}\sum_{i=1}^{n}\sqrt{\mu_A(x_i)*\mu_B(x_i)}
	%\end{equation}
	\item Si $M = \text{Media aritmética}$ y $G_O = \sin(\frac{\pi}{2}(x \cdot y))^{\frac{1}{4}}$:
	\begin{equation}
	O_{sin}(A, B) = \frac{1}{n}\sum_{i=1}^{n}\sin(\frac{\pi}{2}(\mu_A(x_i) \cdot \mu_B(x_i)))^{\frac{1}{4}}
	\end{equation}
\end{itemize}
\end{frame}

\section{Lógica difusa}

\subsection{Método de Mamdani}

\begin{frame}{Método de Mamdani}
Propuesto por Mamdani y Assilian en 1975 para realizar el control de un motor de vapor a partir de un conjunto de reglas obtenidas de operadores humanos experimentados:

\begin{block}{Algoritmo: Método de Mamdani}
	\scalebox{0.90}{
		\begin{algorithm}[H]
		\DontPrintSemicolon
		\KwIn{Un conjunto de reglas $R_{i}$ ($i \in \{1,\ldots,n\}$) con varios antecedentes $A_{ij}$ ($j \in \{1,\ldots,m\}$)  y entradas escalares $x_1,\ldots,x_m$.}
		\KwOut{\emph{B'}.}
		\For{$i \in \{1,\ldots,n\}$} {
		Calcular $k_i = \min(\mu_{Ai1}(x_1),\ldots,\mu_{Aim}(x_m))$ \\
		Calcular $B_i' = \{(y,\min(B_i(y),k_i))|y \in Y\}$
		}
		Construir $B' = \{(y, B'(y))|y \in Y\}$ dado por: \\
		\centering
		\nonl $B'(y) = \max\limits_{i=1}^{n}(B_i')$.\\
		\Return{$B'$}\;
		\end{algorithm}
	}
\end{block}
\end{frame}

\subsection{Método de interpolación}
\begin{frame}{Método de interpolación}
\begin{itemize}
\item Históricamente uno de los métodos más utilizados para resolver sistemas basados en reglas ha sido el \emph{método de interpolación}.
\item  En este método se utiliza la consistencia de Zadeh $O_{Z}(A,B) = \max\limits_{i=1}^{n}(\min(\mu_A(x_i),\mu_B(x_i)))$.
\end{itemize}
\begin{block}{Algoritmo: Método de interpolación}
	\scalebox{0.90}{
		\begin{algorithm}[H]
		\DontPrintSemicolon
		\KwIn{Un conjunto de reglas $R_{j}$, con $j \in \{1,\ldots,n\}$, un hecho \emph{A'} y el índice de consistencia $O_{Z}$}
		\KwOut{\emph{B'}.}
		\For{$j \in \{1,\ldots,n\}$} {
		Calcular $O_{Z}(A',A_{j}) = \max\limits_{x \in X}(\min(A'(x),A_{j}(x))) $
		}
		Construir $B' = \{(y, B'(y))|y \in Y\}$ dado por: \\
		\centering
		\nonl $B'(y) = \max\limits_{j=1}^{n}(\min(B_{j}(y),O_{Z}(A', A_{j})))$.\\
		\Return{$B'$}\;
		\end{algorithm}
	}
\end{block}
\end{frame}

\begin{frame}{Método de interpolación (cont.)}
El método de interpolación se puede generalizar para utilizar cualquier índice de solapamiento y reglas con varios antecedentes:
\begin{block}{Método de interpolación basado en índices de solapamiento}
	\scalebox{0.80}{
		\begin{algorithm}[H]
		\DontPrintSemicolon
		\KwIn{Un conjunto de reglas $R_{j}$ con varios antecedentes, con $j \in \{1,\ldots,n\}$ y un hecho \emph{A'}.}
		\KwOut{\emph{B'}.}
		Seleccionar un operador de agregación $M$, una t-norma \emph{T} y un índice de solapamiento \emph{O}.\\
		\For{$i =1 \to n$} {
		Calcular $O(A'_{i}, A_{i1}),\ldots,O(A'_{m}, A_{im})$\\
		Calcular $k_{i} = T(O(A'_{i}, A_{i1}),\ldots,O(A'_{m}, A_{im}))$\\
		Construir sobre el universo de referencia \emph{Y} el conjunto $K_{i} = \{(y,k_{i})|y \in Y\}$
		}
		Construir $B' = \{(y, B'(y))|y \in Y\}$ dado por: \\
		\centering
		\nonl $B'(y) = \overset{n}{\underset{i=1}{M}}(\min(K_{i},B_{i}))$.\\
		\Return{$B'$}\;
		\end{algorithm}
	}
\end{block}
\end{frame}

\section{Aplicación práctica: riesgo de incendios forestales}
\begin{frame}{Riesgo de incendios forestales}
Entradas (medidas por la red de sensores):
\begin{enumerate}
   \item \bfseries $\chi_1$ - Temperatura: \normalfont medida en grados centígrados (0ºC a 120ºC).
   \item \bfseries $\chi_2$ - Humo: \normalfont medida en partes por millón (0 a 100ppm).
   \item \bfseries $\chi_3$ - Luz: \normalfont medida en lux (0 a 1000 lux).
   \item \bfseries $\chi_4$ - Humedad: \normalfont medida en partes por millón (0 a 100ppm).
   \item \bfseries $\chi_5$ - Distancia: \normalfont medida en metros (0 a 80m).
\end{enumerate}
Salida:
\begin{enumerate}
   \item \bfseries $y$ - Riesgo de incendio: \normalfont porcentaje (0-100\%).
\end{enumerate}
\end{frame}

\begin{frame}
\begin{figure}[H]
	\centering
	\begin{subfigure}[b]{0.45\textwidth}
		\setlength\figureheight{1.35cm}
		\setlength\figurewidth{4.5cm}
		\input{figures/fire-detection-lang-variables/b_temp_lang_variable.tikz}
		\caption{$\chi_1$ - Temperatura (ºC)}
		\label{fig:temp-lang-variable}
	\end{subfigure}
	\qquad
	\begin{subfigure}[b]{0.45\textwidth}
		\setlength\figureheight{1.35cm}
		\setlength\figurewidth{4.5cm}
		\input{figures/fire-detection-lang-variables/b_smoke_lang_variable.tikz}
		\caption{$\chi_2$ - Humo (ppm)}
		\label{fig:smoke-lang-variable}
	\end{subfigure}
	
	\begin{subfigure}[b]{0.45\textwidth}
		\setlength\figureheight{1.35cm}
		\setlength\figurewidth{4.5cm}
		\input{figures/fire-detection-lang-variables/b_light_lang_variable.tikz}
		\caption{$\chi_3$ - Luz (lux)}
		\label{fig:light-lang-variable}
	\end{subfigure}
	\qquad
	\begin{subfigure}[b]{0.45\textwidth}
		\setlength\figureheight{1.35cm}
		\setlength\figurewidth{4.5cm}
		\input{figures/fire-detection-lang-variables/b_humidity_lang_variable.tikz}
		\caption{$\chi_4$ - Humedad (ppm)}
		\label{fig:humidity-lang-variable}
	\end{subfigure}
	
	\begin{subfigure}[b]{0.45\textwidth}
		\setlength\figureheight{1.35cm}
		\setlength\figurewidth{4.5cm}
		\input{figures/fire-detection-lang-variables/b_distance_lang_variable.tikz}
		\caption{$\chi_5$ - Distancia (m)}
		\label{fig:distance-lang-variable}
	\end{subfigure}
	\qquad
	\begin{subfigure}[b]{0.45\textwidth}
		\setlength\figureheight{1.35cm}
		\setlength\figurewidth{4.5cm}
		\input{figures/fire-detection-lang-variables/b_threat_lang_variable.tikz}
		\caption{$y$ - Riesgo de incendio (\%)}
		\label{fig:threat-lang-variable}
	\end{subfigure}
\end{figure}
\end{frame}

\end{document}